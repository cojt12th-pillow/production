var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function c(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function i(e){return document.createElement(e)}function s(e){return document.createTextNode(e)}function f(){return s(" ")}function d(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function h(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function m(e,t){e.value=null==t?"":t}function p(e,t,n){e.classList[n?"add":"remove"](t)}let v;function g(e){v=e}const b=[],$=[],x=[],_=[],y=Promise.resolve();let k=!1;function w(e){x.push(e)}let E=!1;const A=new Set;function C(){if(!E){E=!0;do{for(let e=0;e<b.length;e+=1){const t=b[e];g(t),S(t.$$)}for(g(null),b.length=0;$.length;)$.pop()();for(let e=0;e<x.length;e+=1){const t=x[e];A.has(t)||(A.add(t),t())}x.length=0}while(b.length);for(;_.length;)_.pop()();k=!1,E=!1,A.clear()}}function S(e){if(null!==e.fragment){e.update(),l(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(w)}}const T=new Set;function O(e,t){-1===e.$$.dirty[0]&&(b.push(e),k||(k=!0,y.then(C)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function D(o,r,a,i,s,f,d=[-1]){const h=v;g(o);const m=r.props||{},p=o.$$={fragment:null,ctx:null,props:f,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:[]),callbacks:n(),dirty:d,skip_bound:!1};let b=!1;if(p.ctx=a?a(o,m,((e,t,...n)=>{const l=n.length?n[0]:t;return p.ctx&&s(p.ctx[e],p.ctx[e]=l)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](l),b&&O(o,e)),t})):[],p.update(),b=!0,l(p.before_update),p.fragment=!!i&&i(p.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);p.fragment&&p.fragment.l(e),e.forEach(u)}else p.fragment&&p.fragment.c();r.intro&&(($=o.$$.fragment)&&$.i&&(T.delete($),$.i(x))),function(e,n,o){const{fragment:r,on_mount:a,on_destroy:u,after_update:i}=e.$$;r&&r.m(n,o),w((()=>{const n=a.map(t).filter(c);u?u.push(...n):l(n),e.$$.on_mount=[]})),i.forEach(w)}(o,r.target,r.anchor),C()}var $,x;g(h)}function L(e,t,n){const l=e.slice();return l[14]=t[n],l}function j(e){let t;return{c(){t=i("h2"),t.textContent="まずはあなたの枕と接続しよう！"},m(e,n){a(e,t,n)},d(e){e&&u(t)}}}function B(e){let t,n,c,o,s,p,v,g,b,$,x=e[3],_=[];for(let t=0;t<x.length;t+=1)_[t]=M(L(e,x,t));return{c(){t=i("h2"),t.textContent="アラームを設定しよう！",n=f(),c=i("form"),o=i("input"),s=f(),p=i("div");for(let e=0;e<_.length;e+=1)_[e].c();v=f(),g=i("div"),g.innerHTML='<button class="submit-button svelte-aimc0x" type="submit">設定する</button>',h(o,"type","time"),h(p,"class","weekday-fields svelte-aimc0x"),h(g,"class","button-wrapper svelte-aimc0x"),h(c,"class","svelte-aimc0x")},m(l,u){a(l,t,u),a(l,n,u),a(l,c,u),r(c,o),m(o,e[0]),r(c,s),r(c,p);for(let e=0;e<_.length;e+=1)_[e].m(p,null);var i;r(c,v),r(c,g),b||($=[d(o,"input",e[6]),d(c,"submit",(i=e[5],function(e){return e.preventDefault(),i.call(this,e)}))],b=!0)},p(e,t){if(1&t&&m(o,e[0]),10&t){let n;for(x=e[3],n=0;n<x.length;n+=1){const l=L(e,x,n);_[n]?_[n].p(l,t):(_[n]=M(l),_[n].c(),_[n].m(p,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=x.length}},d(e){e&&u(t),e&&u(n),e&&u(c),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(_,e),b=!1,l($)}}}function M(e){let t,n,l,c,o,m,v,g,b=e[14].label+"";return{c(){t=i("label"),n=i("input"),l=f(),c=i("div"),o=s(b),m=f(),h(n,"type","checkbox"),n.__value=e[14].value,n.value=n.__value,n.hidden=!0,e[8][0].push(n),h(c,"class","weekday svelte-aimc0x"),p(c,"selected",e[1].includes(e[14].value))},m(u,i){a(u,t,i),r(t,n),n.checked=~e[1].indexOf(n.__value),r(t,l),r(t,c),r(c,o),r(t,m),v||(g=d(n,"change",e[7]),v=!0)},p(e,t){2&t&&(n.checked=~e[1].indexOf(n.__value)),10&t&&p(c,"selected",e[1].includes(e[14].value))},d(l){l&&u(t),e[8][0].splice(e[8][0].indexOf(n),1),v=!1,g()}}}function N(t){let n,l,c,o,m,p,v,g,b,$,x=t[2]?"別の枕と接続する":"枕と接続する",_=!t[2]&&j(),y=t[2]&&B(t);return{c(){n=i("main"),l=i("h1"),l.textContent="MakuraFit Adventure",c=f(),_&&_.c(),o=f(),m=i("div"),p=i("button"),v=s(x),g=f(),y&&y.c(),h(l,"class","svelte-aimc0x"),h(p,"class","connect-button svelte-aimc0x"),h(p,"type","button"),h(m,"class","button-wrapper svelte-aimc0x"),h(n,"class","svelte-aimc0x")},m(e,u){a(e,n,u),r(n,l),r(n,c),_&&_.m(n,null),r(n,o),r(n,m),r(m,p),r(p,v),r(n,g),y&&y.m(n,null),b||($=d(p,"click",t[4]),b=!0)},p(e,[t]){e[2]?_&&(_.d(1),_=null):_||(_=j(),_.c(),_.m(n,o)),4&t&&x!==(x=e[2]?"別の枕と接続する":"枕と接続する")&&function(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}(v,x),e[2]?y?y.p(e,t):(y=B(e),y.c(),y.m(n,null)):y&&(y.d(1),y=null)},i:e,o:e,d(e){e&&u(n),_&&_.d(),y&&y.d(),b=!1,$()}}}const P="6e400001-b5a3-f393-e0a9-e50e24dcca9e";function q(e,t,n){let l=null,c=[];let o=!0,r=null,a=null,u=null;const i=e=>u?.writeValue((new TextEncoder).encode(e+"\n")),s=[[]];return[l,c,o,[{value:1,label:"月"},{value:2,label:"火"},{value:3,label:"水"},{value:4,label:"木"},{value:5,label:"金"},{value:6,label:"土"},{value:7,label:"日"}],()=>{if(navigator.bluetooth&&navigator.bluetooth.requestDevice)return o?(r.disconnect(),void n(2,o=!1)):void navigator.bluetooth.requestDevice({filters:[{services:[P]},{namePrefix:"BBC micro:bit"}]}).then((e=>(r=e.gatt,r.connect()))).then((e=>e.getPrimaryService(P))).then((e=>Promise.all([e.getCharacteristic("6e400002-b5a3-f393-e0a9-e50e24dcca9e"),e.getCharacteristic("6e400003-b5a3-f393-e0a9-e50e24dcca9e")]))).then((e=>{a=e[0],a.startNotifications(),a.addEventListener("characteristicvaluechanged",(e=>(e=>console.log(e))((new TextDecoder).decode(e.target.value)))),u=e[1],n(2,o=!0),i(`SET_DATE:${(new Date).toISOString()}`)})).catch((function(e){alert(e)}));alert("WebBluetooth に未対応のブラウザです。")},()=>{console.log(l,c);let e="";l||(e+="時刻を設定してください！\n"),c.length||(e+="曜日を設定してください！\n"),e.length?alert(e):(i(`SET_ALERM:${l.replace(":",",")},${c.join(",")}`),alert("アラームを設定しました！"))},function(){l=this.value,n(0,l)},function(){c=function(e,t,n){const l=new Set;for(let t=0;t<e.length;t+=1)e[t].checked&&l.add(e[t].__value);return n||l.delete(t),Array.from(l)}(s[0],this.__value,this.checked),n(1,c)},s]}return new class extends class{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),D(this,e,q,N,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
